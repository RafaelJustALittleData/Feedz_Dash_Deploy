[{"name":"app.R","content":"#\n# This is a Shiny web application. You can run the application by clicking\n# the 'Run App' button above.\n#\n# Find out more about building applications with Shiny here:\n#\n#    http://shiny.rstudio.com/\n#\n\nlibrary(shiny)\nlibrary(shinydashboard)\n# Define UI for application that draws a histogram\nlibrary(shiny)\nlibrary(shinydashboard)\nlibrary(plotly)\n#library(shinydashboardPlus)\nlibrary(visNetwork)\n\n\n\n#titulo<-dashboardHeader(title = \"Analise Resultado Feedz\",titleWidth = 450)\ntitulo=dashboardHeader()\n\ntitulo$children[[2]]$children <-  tags$a(href='http://just.bi',\n                                         tags$img(src='logo.png',height='40',width='200'))\n\n\nmenu<- dashboardSidebar(width = 250,\n                        tags$style(type=\"text/css\",\n                                   \".shiny-output-error { visibility: hidden; }\",\n                                   \".shiny-output-error:before { visibility: hidden; }\"\n                        ),\n                        sidebarMenu(id=\"Tab\",\n                                    menuItem(\"Tabela\", tabName = \"Tabela\", icon = icon(\"dashboard\")),\n                                    menuItem(\"Visao Individuo\", tabName = \"VisaoIndividuo\", icon = icon(\"dashboard\")),\n                                    menuItem(\"Visao Time\",tabName=\"VisaoTime\",icon=icon(\"dashboard\")),\n                                    menuItem(\"Visao Temporal\",tabName=\"VisaoTemporal\",icon=icon(\"dashboard\")),\n                                    \n                                    menuItem('Wordclouds',tabName = 'Wordclouds',icon=icon('dashboard')),\n                                    menuItem('Coocorrencia de termos',tabName = 'Grafo',icon=icon('dashboard')),\n                                    menuItem(\"Visao de Gestor\", tabName = \"Segmentacao\", icon = icon(\"dashboard\")),\n                                    menuItem(\"Sobre\", tabName = \"Sobre\", icon = icon(\"th\")),\n                                    \n                                    uiOutput('Gerador_Seletor_Pessoas'),\n                                    selectInput('Seletor_Agrupador','Selecione se usaremos agrupador de valores ou não',choices=c('Sim','Nao'))\n                        )\n                        \n                        \n                        \n)\n\n\n\n## Body content\ncorpo<- dashboardBody(\n  fileInput('Entrada',label='Incluir dados de avaliação aqui'),\n  \n  dataTableOutput('Correlacao'),\n  \n  \n  tabItems(\n    # First tab content\n    tabItem(tabName = \"Tabela\",\n            fluidRow(\n              dataTableOutput(\"Tabela\")\n              \n              \n            )\n    ),\n    \n    tabItem(tabName = \"VisaoIndividuo\",\n            fluidRow(\n              plotOutput('Visao_Comparativa')\n              \n              \n            )\n    ),\n    \n    tabItem(tabName = \"VisaoTime\",\n            fluidRow(\n              #plotOutput('Visao_Global')\n              box(plotOutput('Visao_AutoAvaliacao')),\n              box(plotOutput('Visao_Gestor')),\n              box(plotOutput('Visao_Outros')),\n              box(plotOutput('Visao_Media'))\n              \n            )\n    ),\n    \n    tabItem(tabName = \"VisaoTemporal\",\n            fluidRow(\n              plotlyOutput('Temporal')\n              \n              \n            )\n    ),\n    \n    tabItem(tabName = \"Wordclouds\",\n            fluidRow(\n              plotOutput('WordCloud')\n              \n              \n            )\n    ),\n    \n    tabItem(tabName = \"Grafo\",\n            fluidRow(\n              numericInput('OcorrenciaMinima',label = 'Minima quantidade de vezes que uma palavra ocorre',value = 2,min=1,max=1000),\n              plotOutput('Grafo'))\n              #visNetworkOutput('Grafo_Dinamico'))\n            \n            \n    ),\n\n\n    tabItem(tabName = \"Segmentacao\",\n            fluidRow(\n                            plotlyOutput('Segmentacao_Time')\n              \n              \n            )\n    ),\n\n    \n  \n  tabItem(tabName = \"Sobre\",\n          fluidRow(\n            uiOutput('GeradorSobre')\n            \n            \n          )\n  )\n  ),\n\n      \n\n  \n  \n  \n  \n  \n  \n  \n  \n)\n\n\n\n\n\n\nui <- dashboardPage(titulo,menu,corpo,skin=\"black\",title = \"Analise Resultado Feedz\")\n# Define server logic required to draw a histogram\nrequire(shiny)\nsource('Funcoes_Base.R')\nrequire(plotly)\nrequire(ggthemes)\n\n\nrequire(tidyr)\nrequire(dplyr)\nrequire(lubridate)\n\nserver <- function(input, output) {\n  #Funções reativas\n  #_________________________________________________________________________________________  \n  \n  \n  leitura_old_legada<-reactive({\n    file <- input$Entrada\n    ext <- tools::file_ext(file$datapath)\n    \n    req(file)\n    validate(need(ext == \"csv\", \"Formato de arquivo errado\"))\n    \n    \n    df=read.csv(file$datapath,encoding = 'UTF-8')\n    names(df)[1:3]=c('Competencia','Descricao','Autoavaliacao')\n    df=df %>% mutate(Media_Ajustada=(Gestor.direto*0.5 + Outros.Avaliadores*0.2)/0.7 )\n    \n    \n    return(df)\n  })\n  \n  leitura_old<-reactive({\n    file <- input$Entrada\n    ext <- tools::file_ext(file$datapath)\n    \n    req(file)\n    validate(need(ext == \"csv\", \"Formato de arquivo errado\"))\n    \n    \n    df=read.csv(file$datapath,encoding = 'UTF-8')\n    #names(df)[1:3]=c('Competencia','Descricao','Autoavaliacao')\n    \n    df=df %>%  mutate(\n      Data.da.resposta=dmy(Data.da.resposta),\n      month = month(Data.da.resposta),\n      year = year(Data.da.resposta),\n      data=dmy(paste0('01-0',month,'-',year))\n    ) \n\n    #df1=df[,c('Competência','Tipo.de.Avaliador','Nota','Feedback','Data.da.resposta','Avaliador')]\n    Comentarios=df %>% select(Competência,Avaliador,Feedback,Avaliado=Nome,data) %>% pivot_wider(id_cols=c('Competência','Avaliado','data'),values_from='Feedback',names_from = 'Avaliador') \n    \n    dim(Comentarios)[2]\n    names(Comentarios)[4:dim(Comentarios)[2]]=paste0('Avaliador.',1:(dim(Comentarios)[2]-3) )\n    #head(Comentarios)\n    \n    Notas=df %>% group_by(Competência,Tipo.de.Avaliador,Avaliado=Nome,data) %>% summarize(Nota=mean(Nota)) %>% pivot_wider(id_cols=c('Competência','Avaliado','data'),values_from='Nota',names_from = 'Tipo.de.Avaliador')\n    #head(Notas)\n    \n    Result=Notas %>% inner_join(Comentarios) %>%\n      rename(Outros.Avaliadores=`Avaliação do avaliador/par`,Gestor.direto=`Avaliação do gestor`,Competencia=Competência,Autoavaliacao=Autoavaliação) %>%\n      mutate(Media.Final=0.3*Autoavaliacao + 0.5*Gestor.direto + 0.2*Outros.Avaliadores\n      )\n    # Para os casos que os outros não opinão\n    Logico=is.na(Result[,c('Outros.Avaliadores')] )\n    if(sum(Logico)>0){\n      Result[Logico,'Media.Final']= (0.5 * Result[Logico,'Gestor.direto'] + 0.3 * Result[Logico,'Autoavaliacao'] )/0.8 \n    }\n    \n    Logico=is.na(Result[,c('Autoavaliacao')] ) | Result[,c('Autoavaliacao')]==0\n    if(sum(Logico)>0){\n      Result[Logico,'Media.Final']= (0.5 * Result[Logico,'Gestor.direto'] )/0.5\n      Result[Logico,'Autoavaliacao']=NA\n    }\n    \n    df=Result\n    print(df)\n    \n    \n    return(df)\n  })\n\n\n  \n  \n  leitura<-reactive({\n    df = leitura_old()\n    df=df %>% filter(data==max(data)) #%>% select(-data)\n    return(df)\n  })\n  \n  \n  leitura_Valores=reactive({\n    \n    df=leitura()\n    aux=Dicionario()\n    df=df %>% inner_join(aux) %>% group_by(Dict,Avaliado) %>% \n      summarize(Autoavaliacao=mean(Autoavaliacao),Gestor.direto=mean(Gestor.direto),Outros.Avaliadores=mean(Outros.Avaliadores),Media.Final=mean(Media.Final)) %>% mutate(Competencia=Dict) %>% ungroup() %>% select(-Dict)\n    df=df %>% mutate(Media_Ajustada=(Gestor.direto*0.5 + Outros.Avaliadores*0.2)/0.7 )\n    \n    Logico=is.na(df[,c('Outros.Avaliadores')] )\n    if(sum(Logico)>0){\n      df[Logico,'Media_Ajustada']= df[Logico,'Gestor.direto']  \n    }\n    \n    return(df)\n  })\n  \n  \n  leitura_Valores_old=reactive({\n    \n    df=leitura_old()\n    aux=Dicionario()\n    df=df %>% inner_join(aux) %>% group_by(Dict,Avaliado,data) %>% \n      summarize(Autoavaliacao=mean(Autoavaliacao),Gestor.direto=mean(Gestor.direto),Outros.Avaliadores=mean(Outros.Avaliadores),Media.Final=mean(Media.Final)) %>% mutate(Competencia=Dict) %>% ungroup() %>% select(-Dict)\n    df=df %>% mutate(Media_Ajustada=(Gestor.direto*0.5 + Outros.Avaliadores*0.2)/0.7 )\n    Logico=is.na(df[,c('Outros.Avaliadores')] )\n    if(sum(Logico)>0){\n      df[Logico,'Media_Ajustada']= df[Logico,'Gestor.direto']  \n    }\n    \n    return(df)\n  })\n  \n  \n  tdm<-reactive({\n    \n    df=leitura()\n    \n    Colaborador=input$Seletor_Pessoas\n    df=df %>% filter(Avaliado==Colaborador)\n    Matriz=Gerar_Matriz_Termo_Documento(df,Colaborador)\n    return(Matriz)\n  })\n\n  \n    \n  \n  \n  \n  #Funcoes geradoras de UI\n  #_______________________________________________________________________________\n  \n  output$Gerador_Seletor_Pessoas<- renderUI({\n    \n    arquivo=leitura_old()\n    if(!is.null(arquivo)){\n      Pessoas=unique(arquivo$Avaliado)\n      selectInput('Seletor_Pessoas','Selecione as pessoa que quer observar os resultados',choices=Pessoas)\n    }\n  })\n  \n  output$GeradorSobre<-renderUI({\n    \n    if(input$Tab==\"Sobre\"){\n      h4('Desenvolvido pelo time de Data Science\\n Para mais detalhes ou expansão, abrir tarefa no kambam e comunicar o lider atual ')\n      \n      \n    }\n  })\n  \n  #Funcoes que geram telas\n  #__________________________________________________________________________________________\n  output$Visao_Comparativa<-renderPlot({\n    \n    \n    if(input$Seletor_Agrupador==\"Sim\"){\n      df=leitura_Valores()\n    }else{\n      df=leitura()\n    }\n    df=df[,-which(names(df)==\"Media.Final\")]\n    Colaborador=input$Seletor_Pessoas\n    #Gerar_Visual_Deia(df,Colaborador)\n    p<-Gerar_Visual_Comparativo(df,Colaborador)\n    p\n    #ggplotly(p)\n  })\n  \n  output$Visao_Global<-renderPlot({\n    \n    if(input$Seletor_Agrupador==\"Sim\"){\n      df=leitura_Valores()\n    }else{\n      df=leitura()\n    }\n    \n    #df=df[,-which(names(df)==\"Media.Final\")]\n    Colaborador=input$Seletor_Pessoas\n    p<-Gerar_Visual_Deia(df,Colaborador)\n    #p<-Gerar_Visual_Comparativo(df,Colaborador)\n    p\n    #ggplotly(p)\n  })\n  \n  output$Visao_AutoAvaliacao<-renderPlot({\n    \n    if(input$Seletor_Agrupador==\"Sim\"){\n      df=leitura_Valores()\n    }else{\n      df=leitura()\n    }\n    \n    #df=df[,-which(names(df)==\"Media.Final\")]\n    Colaborador=input$Seletor_Pessoas\n    p<-Gerar_Visual_Deia_Lista(df,Colaborador)\n    #p<-Gerar_Visual_Comparativo(df,Colaborador)\n    p$AutoAvaliacao\n    #ggplotly(p)\n  })\n  \n  output$Visao_Gestor<-renderPlot({\n    \n    if(input$Seletor_Agrupador==\"Sim\"){\n      df=leitura_Valores()\n    }else{\n      df=leitura()\n    }\n    \n    #df=df[,-which(names(df)==\"Media.Final\")]\n    Colaborador=input$Seletor_Pessoas\n    p<-Gerar_Visual_Deia_Lista(df,Colaborador)\n    #p<-Gerar_Visual_Comparativo(df,Colaborador)\n    p$Gestor\n    #ggplotly(p)\n  })\n  \n  output$Visao_Outros<-renderPlot({\n    \n    if(input$Seletor_Agrupador==\"Sim\"){\n      df=leitura_Valores()\n    }else{\n      df=leitura()\n    }\n    \n    #df=df[,-which(names(df)==\"Media.Final\")]\n    Colaborador=input$Seletor_Pessoas\n    p<-Gerar_Visual_Deia_Lista(df,Colaborador)\n    #p<-Gerar_Visual_Comparativo(df,Colaborador)\n    p$Outros\n    #ggplotly(p)\n  })\n  \n  output$Visao_Media<-renderPlot({\n    \n    if(input$Seletor_Agrupador==\"Sim\"){\n      df=leitura_Valores()\n    }else{\n      df=leitura()\n    }\n    \n    #df=df[,-which(names(df)==\"Media.Final\")]\n    Colaborador=input$Seletor_Pessoas\n    p<-Gerar_Visual_Deia_Lista(df,Colaborador)\n    #p<-Gerar_Visual_Comparativo(df,Colaborador)\n    p$Media\n    #ggplotly(p)\n  })\n  \n  \n  output$Tabela<-renderDataTable({\n    if(input$Seletor_Agrupador==\"Sim\"){\n      df=leitura_Valores()\n    }else{\n      df=leitura()\n    }\n    Colaborador=input$Seletor_Pessoas\n    df %>% filter(Avaliado==Colaborador)\n    \n  })\n  \n  output$Correlacao<-renderDataTable({\n    if(input$Tab==\"Tabela\"){\n      if(input$Seletor_Agrupador==\"Sim\"){\n        df=leitura_Valores()\n      }else{\n        df=leitura()\n      }\n      Colaborador=input$Seletor_Pessoas\n      df=df %>% filter(Avaliado==Colaborador)\n      df$Autoavaliacao=(df$Autoavaliacao<=3.5 & df$Autoavaliacao>=3.0 )*1 + (df$Autoavaliacao>3.5)*2#(df$Autoavaliacao==3)*1 + (df$Autoavaliacao>3)*2\n      df$Gestor.direto=(df$Gestor.direto<=3.5 & df$Gestor.direto>=3.0 )*1 + (df$Gestor.direto>3.5)*2#(df$Gestor.direto==3)*1 + (df$Gestor.direto>3)*2\n      df$Outros.Avaliadores=(df$Outros.Avaliadores<=3.5 & df$Outros.Avaliadores>=3.0 )*1 + (df$Outros.Avaliadores>3.5)*2\n      lista=list(Origem=c('Autoavaliacao','Autoavaliacao','Gestor'),Destino=c('Gestor','Outros','Outros'),Score=c(mean(df$Autoavaliacao==df$Gestor.direto,na.rm=TRUE),mean(df$Autoavaliacao==df$Outros.Avaliadores,na.rm=TRUE),mean(df$Outros.Avaliadores==df$Gestor.direto,na.rm=TRUE)  ) )\n      \n      return(data.frame(lista))\n      #Matriz=cor(df[,c('Autoavaliacao','Gestor.direto','Outros.Avaliadores')],method='pearson') %>% melt() %>% filter(Var1!=Var2)\n      #Matriz=Matriz[!duplicated(Matriz$value),]\n      #names(Matriz)[3]='pearson'\n      #Matriz\n    }\n  })\n  \n  output$WordCloud<-renderPlot({\n    Matriz=tdm()\n    Frequencia=Gerar_WordCloud(Matriz)\n    print(Frequencia)\n    require(wordcloud)\n    #print(data.frame(word=names(Frequencia),Contagem=as.numeric(Frequencia)) %>% inner_join(parts_of_speech) )\n    \n    wordcloud(names(Frequencia),as.numeric(Frequencia)) \n  })\n  \n  output$Grafo<-renderPlot({\n    Matriz=tdm()\n    Matriz=t(Matriz)\n    Grafo=Gerar_Grafo(Matriz,input$OcorrenciaMinima)\n    plot(Grafo)\n  })\n  \n  output$Grafo_Dinamico<-renderVisNetwork({\n    Matriz=tdm()\n    Matriz=t(Matriz)\n    Grafo=Gerar_Grafo(Matriz,input$OcorrenciaMinima)\n    visIgraph(Grafo)\n    \n  })\n  \n  output$Temporal<-renderPlotly({\n    #renderPlotly({\n    if(input$Seletor_Agrupador==\"Sim\"){\n      df=leitura_Valores_old()\n    }else{\n      df=leitura_old()\n    }\n    require(reshape2)\n    Colaborador=input$Seletor_Pessoas\n    df=df %>% filter(Avaliado==Colaborador)\n    df=df %>% ungroup()\n    df=df %>% select(Competencia,data,Outros.Avaliadores,Gestor.direto,Media.Final)\n    df = df %>% melt(id=c('data','Competencia') )\n    print(df)\n    require(lubridate)\n    p<-ggplot(df) + aes(x=data,y=value,colour=Competencia) + geom_line() + facet_wrap(~variable) + labs(x='Data de referencia') + ylim(1,5) + geom_point()\n    ggplotly(p)\n    \n  })\n\n  output$Segmentacao_Time<-renderPlotly({\n        \n      if(input$Seletor_Agrupador==\"Sim\"){\n        df=leitura_Valores()\n      }else{\n        df=leitura()\n      }\n      #print(df)\n      Resultado=df %>% select(Media.Final,Avaliado,Competencia)\n      Resultado=Resultado[complete.cases(Resultado),]\n      print(Resultado)\n      Resultado=Resultado %>% pivot_wider(id_cols='Avaliado',values_from='Media.Final',names_from='Competencia')\n      print(Resultado)\n      PCA=prcomp(Resultado[,-1],scale=TRUE)\n      sdev <- PCA$sdev\n      variance_explained_manual <- (sdev^2) / sum(sdev^2)\n      variance_first_two_manual <- sum(variance_explained_manual[1:2])\n      pca_data=as.data.frame(PCA$x)\n      loadings <- as.data.frame(PCA$rotation)\n      pca_data[,'Avaliado']=Resultado[,1]\n\n      p <- ggplot(pca_data, aes(x = PC1, y = PC2)) +\n      geom_text(size = 3,aes(label = Avaliado)) +\n      geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1 * 5, yend = PC2 * 5), \n               arrow = arrow(length = unit(0.2, \"cm\")), color = \"red\") +\n      geom_text(data = loadings, aes(x = PC1 * 5, y = PC2 * 5, label = rownames(loadings)), \n            color = \"red\", vjust = 1, hjust = 1,position = position_jitter(width = 0.3, height = 0.3)) +\n      theme_minimal() +\n      labs(title = \"PCA do time\",\n         x = paste0(\"First Principal Component: \",variance_explained_manual[1] *100,'%'),\n         y = paste0(\"Second Principal Component: \",variance_explained_manual[2] *100,'%'),subtitle=paste('Percentual de variabilide explicada é de ',variance_first_two_manual))\n\n      ggplotly(p)\n\n  })\n  \n  \n  \n  \n}\n# Run the application \nshinyApp(ui = ui, server = server)\n","type":"text"},{"name":"Funcoes_Base.R","content":"require(dplyr)\nrequire(reshape2)\nrequire(ggplot2)\n\n\nDicionario<-function(){\n  require(dplyr)\n  Core=list(data.frame('Competencia'='Inquietude','Dict'='Valores'),\n            data.frame('Competencia'='Conhecimento profundo do que faz','Dict'='Valores'),\n            data.frame('Competencia'='Foco na solução','Dict'='Valores'),\n            data.frame('Competencia'='Transparência','Dict'='Valores'),\n            data.frame('Competencia'='Assertividade','Dict'='Valores'),\n            \n            data.frame('Competencia'='Ownership','Dict'='Empredimento'),\n            data.frame('Competencia'='Resolver / Fazer','Dict'='Empredimento'),\n            \n            data.frame('Competencia'='Gestão do Tempo','Dict'='Disponibilidade'),\n            data.frame('Competencia'='Pontualidade','Dict'='Disponibilidade'),\n            data.frame('Competencia'='Acessibilidade','Dict'='Disponibilidade'),\n            \n            data.frame('Competencia'='Relacionamento interpessoal com outras áreas','Dict'='Colaboração'),\n            data.frame('Competencia'='Relacionamento interpessoal com o time','Dict'='Colaboração'),\n            data.frame('Competencia'='Comunicação','Dict'='Colaboração'),\n            data.frame('Competencia'='Prontidão','Dict'='Colaboração'),\n            \n            data.frame('Competencia'='Domínio do Workspace','Dict'='Hard Skills'),\n            data.frame('Competencia'='Domínio de Ferramentas / Softwares','Dict'='Hard Skills'),\n            \n            data.frame('Competencia'='Inteligência emocional','Dict'='Postura'),\n            data.frame('Competencia'='Maturidade profissional','Dict'='Postura'),\n            \n            data.frame('Competencia'='Potencial','Dict'='Performance'),\n            data.frame('Competencia'='Desempenho','Dict'='Performance')\n  ) %>% bind_rows()\n  \n  Encoding(Core$Competencia) <-'UTF-8'\n  return(Core)\n  \n}\n\n\n\n\nGerar_Visual_Deia<-function(df,Colaborador){\n  require(reshape2)\n  require(ggplot2)\n  require(ggthemes)\n  \n  \n  require(dplyr)\n  Core_Comparacao = df %>% \n    filter(Avaliado!=Colaborador) %>% group_by(Competencia) %>% \n    summarize(Autoavaliacao=mean(Autoavaliacao),\tGestor=mean(Gestor.direto)\t,Outros=mean(Outros.Avaliadores)\t,Media=mean(Media.Final)\t) %>%\n    mutate(Avaliado=\"Referencia\") %>%\n    rbind( df %>% filter(Avaliado==Colaborador) %>% select(Avaliado,Competencia,Autoavaliacao,Gestor=Gestor.direto,Outros=Outros.Avaliadores,Media=Media.Final)  )\n  \n  \n  Grafico<-Core_Comparacao %>% melt() %>%\n    ggplot(aes(x=Competencia, y=value)) +\n    geom_line(aes(col = Avaliado,group=Avaliado)) + geom_point(aes(col=Avaliado)) + coord_polar()+ geom_hline(yintercept = 3) + ylim(0,5) +\n    theme_excel_new() + labs(x='Nota',y='') + scale_fill_manual(values = c( \"red\", \"blue\",'white')) + facet_wrap(~variable)\n\n  return(Grafico)\n}\n\n\n\nGerar_Visual_Deia_Lista<-function(df,Colaborador){\n  require(reshape2)\n  require(ggplot2)\n  require(ggthemes)\n  \n  \n  require(dplyr)\n  Core_Comparacao = df %>% \n    filter(Avaliado!=Colaborador) %>% group_by(Competencia) %>% \n    summarize(Autoavaliacao=mean(Autoavaliacao),\tGestor=mean(Gestor.direto)\t,Outros=mean(Outros.Avaliadores)\t,Media=mean(Media.Final)\t) %>%\n    mutate(Avaliado=\"Referencia\") %>%\n    rbind( df %>% filter(Avaliado==Colaborador) %>% select(Avaliado,Competencia,Autoavaliacao,Gestor=Gestor.direto,Outros=Outros.Avaliadores,Media=Media.Final)  )\n  \n  \n  AutoAvaliacao<-Core_Comparacao %>% melt() %>% filter(variable=='Autoavaliacao') %>%\n    ggplot(aes(x=Competencia, y=value)) +\n    geom_line(aes(col = Avaliado,group=Avaliado)) + geom_point(aes(col=Avaliado)) + coord_polar()+ geom_hline(yintercept = 3) + ylim(0,5) +\n    theme_excel_new() + labs(x='Nota',y='') + scale_fill_manual(values = c( \"red\", \"blue\",'white')) + facet_wrap(~variable)\n  \n  \n  Gestor<-Core_Comparacao %>% melt() %>% filter(variable=='Gestor') %>%\n    ggplot(aes(x=Competencia, y=value)) +\n    geom_line(aes(col = Avaliado,group=Avaliado)) + geom_point(aes(col=Avaliado)) + coord_polar()+ geom_hline(yintercept = 3) + ylim(0,5) +\n    theme_excel_new() + labs(x='Nota',y='') + scale_fill_manual(values = c( \"red\", \"blue\",'white')) + facet_wrap(~variable)\n  \n  \n  Outros<-Core_Comparacao %>% melt() %>% filter(variable=='Outros') %>%\n    ggplot(aes(x=Competencia, y=value)) +\n    geom_line(aes(col = Avaliado,group=Avaliado)) + geom_point(aes(col=Avaliado)) + coord_polar()+ geom_hline(yintercept = 3) + ylim(0,5) +\n    theme_excel_new() + labs(x='Nota',y='') + scale_fill_manual(values = c( \"red\", \"blue\",'white')) + facet_wrap(~variable)\n  \n  \n  \n  Media<-Core_Comparacao %>% melt() %>% filter(variable=='Media') %>%\n    ggplot(aes(x=Competencia, y=value)) +\n    geom_line(aes(col = Avaliado,group=Avaliado)) + geom_point(aes(col=Avaliado)) + coord_polar()+ geom_hline(yintercept = 3) + ylim(0,5) +\n    theme_excel_new() + labs(x='Nota',y='') + scale_fill_manual(values = c( \"red\", \"blue\",'white')) + facet_wrap(~variable) \n  \n  Grafico=list(AutoAvaliacao,Gestor,Outros,Media)\n  names(Grafico)=c('AutoAvaliacao','Gestor','Outros','Media')\n  \n  return(Grafico)\n}\n\n\n\n\nGerar_Visual_Comparativo<-function(df,Colaborador){\n  require(reshape2)\n  require(ggplot2)\n  require(ggthemes)\n  Grafico=df %>% \n    filter(Avaliado==Colaborador) %>% melt() %>%\n    ggplot(aes(x=Competencia, y=value)) +\n    geom_line(aes(col = variable,group=variable)) + geom_point(aes(col=variable)) + coord_polar()+ geom_hline(yintercept = 3) + ylim(0,5) +\n    theme_excel_new() + labs(x='Nota',y='') \n  return(Grafico)\n}\n\n\n\nGerar_Matriz_Termo_Documento<-function(df,Colaborador){\n  require(tm) \n  require(tidyr)\n  Avaliacoes=df %>% \n    filter(Avaliado==Colaborador) %>%\n    select(starts_with('Avaliador')) %>% gather() %>%\n    select(Avaliador=value) %>% mutate(Avaliador=removeNumbers(Avaliador),\n                                       Avaliador=tolower(Avaliador),\n                                       Avaliador=removeWords(Avaliador,stopwords('pt')),\n                                       Avaliador=removePunctuation(Avaliador) )\n  Matriz=TermDocumentMatrix(Corpus(VectorSource(Avaliacoes$Avaliador)) )\n  return(Matriz)\n  \n}\n\n\nGerar_WordCloud<-function(Matriz){\n  require(wordcloud)\n  Frequencia=rowSums(as.matrix(Matriz) )\n  return(Frequencia)\n  #return(wordcloud(names(Frequencia),as.numeric(Frequencia)) )\n\n}\n\nGerar_Grafo<-function(Matriz,Corte){\n  \n  Adjacencia=as.matrix(t(Matriz)) %*% as.matrix(Matriz)\n  \n  Lista=melt(1*(Adjacencia>=Corte)) \n  \n  names(Lista)=c('Origem','Destino','Valor')\n  Lista=Lista %>% filter(Valor>0,Origem!=Destino)\n  \n  require(igraph)\n  Grafo=graph_from_data_frame(Lista)\n  return(Grafo)\n}","type":"text"},{"name":"Funcoes_Geradoras_UI.R","content":"require(shiny)\n\noutput$Gerador_Seletor_Pessoas<- renderUI({\n  \n  arquivo=leitura()\n  #if(!is.null(arquivo)){\n    Pessoas=unique(arquivo$Avaliado)\n    selectInput('Seletor_Pessoas','Selecione as pessoa que quer observar os resultados',choices=Pessoas)\n  #}\n})","type":"text"},{"name":"Funcoes_Reativas.R","content":"require(shiny)\n\nleitura<-reactive({\n  if(!is.null(input$Entrada$datapath) ){\n    \n    dataset=read.csv(input$Entrada$datapath)\n    return(dataset)\n  }\n  return(NA)\n  \n  \n  \n})\n\nleitura<-reactive({\nfile <- input$Entrada\next <- tools::file_ext(file$datapath)\n\nreq(file)\nvalidate(need(ext == \"csv\", \"Formato de arquivo errado\"))\n\nreturn(read.csv(file$datapath))\n})","type":"text"},{"name":"README.md","content":"# Feedz_Dash\nPublicacao para disponibilizar o dashboard de analise do feez\n","type":"text"}]
